package co.com.mercadolibre.mutantdetector.service.strategy;

import java.util.Arrays;
import java.util.List;
import java.util.concurrent.atomic.AtomicInteger;
import java.util.stream.IntStream;

public interface MutantDetectStrategy {

    int MATCH_SEQUENCE = 4;
    int MAX_SEQUENCE = 1;

    /**
     * Check if a given DNA sequence has only 4 consecutive codes of any letter
     * @param dna DNA sequence generated by the strategy algorithms
     * @return true if the given DNA sequence match with 4 consecutive codes, otherwise false
     */
    default boolean verifySequenceDNA(String dna) {
        AtomicInteger max = new AtomicInteger(1);
        List<String> splitDNA = Arrays.asList(dna.split(""));

        IntStream.range(1, splitDNA.size()).forEach(i -> {
            int count = 1;
            while (i < splitDNA.size() && splitDNA.get(i - 1).equals(splitDNA.get(i))) {
                count++;
                i++;
                max.set(Math.max(count, max.get()));
            }
        });

        return max.get() == MATCH_SEQUENCE;
    }

    Long execute(String[][] fullDNA);
}
